
<!doctype html>
<html>
<head>
<meta name="chromevox" content-script="no">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" nonce="1eW8xmzWpd7L5hTYp6K1IA"><link rel="stylesheet" href="/static/macros/client/css/4235841637-mae_html_css_ltr.css">
<script type="text/javascript" src="/static/macros/client/js/1632287126-warden_bin_i18n_warden__pt_br.js" nonce="TR_FeU011eq094-G2iKqbA"></script>
</head>
<body>
<table id="warning-bar-table" class="full_size" cellspacing="0" cellpadding="0"><tr><td><div id="warning" class="warning-bar"></div></td></tr><tr><td style="height: 100%"><iframe id="sandboxFrame" allow="accelerometer *; ambient-light-sensor *; autoplay *; camera *; clipboard-read *; clipboard-write *; encrypted-media *; fullscreen *; geolocation *; gyroscope *; magnetometer *; microphone *; midi *; payment *; picture-in-picture *; screen-wake-lock *; speaker *; sync-xhr *; usb *; web-share *; vibrate *; vr *" sandbox="allow-downloads allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation allow-storage-access-by-user-activation">
</iframe>
</td></tr></table><script nonce="TR_FeU011eq094-G2iKqbA">
(function() {
var el = document.getElementById('sandboxFrame');
el.onload = function() {
goog.script.init("\x7b\x22functionNames\x22:\x5b\x22doGet\x22,\x22searchSheet\x22\x5d,\x22sandboxMode\x22:\x22IFRAME_SANDBOX\x22,\x22callbackTimeout\x22:390000,\x22deploymentId\x22:\x22AKfycbyjQUTSv0uXvhSb2ML7Z9CF2kCFn6gQBL3Y-wSPoYDUJflIQmwf7Pm9j6cW1oT2w6Rs\x22,\x22eei\x22:\x22\x22,\x22sandboxHost\x22:\x22https:\/\/n-vdleir65377mpxdm46abhh6k3gsnscuj7li75mq-0lu-script.googleusercontent.com\x22,\x22clientSideProperties\x22:\x7b\x22google.script.sandbox.mode\x22:\x22IFRAME_SANDBOX\x22,\x22google.script.host.origin\x22:\x22https:\/\/docs.google.com\x22\x7d,\x22actionPrefix\x22:\x22\/macros\/s\/AKfycbyjQUTSv0uXvhSb2ML7Z9CF2kCFn6gQBL3Y-wSPoYDUJflIQmwf7Pm9j6cW1oT2w6Rs\x22,\x22userHtml\x22:\x22\x3c!DOCTYPE html\x3e\\n\x3chtml lang\x3d\\\x22pt-BR\\\x22\x3e\\n\x3chead\x3e\\n  \x3cmeta name\x3d\\\x22viewport\\\x22 content\x3d\\\x22width\x3ddevice-width, initial-scale\x3d1\\\x22\x3e\\n  \x3clink rel\x3d\\\x22stylesheet\\\x22 href\x3d\\\x22https:\/\/unpkg.com\/leaflet@1.9.4\/dist\/leaflet.css\\\x22 \/\x3e\\n  \x3cstyle\x3e\\n    body \x7b\\n      font-family: Arial, sans-serif;\\n      margin: 0;\\n      padding: 0;\\n      background-color: #f4f4f4;\\n      color: #333;\\n    \x7d\\n\\n    .container \x7b\\n      width: 90%;\\n      max-width: 1200px;\\n      margin: auto;\\n      padding: 20px;\\n      background: #fff;\\n      border-radius: 8px;\\n      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\\n    \x7d\\n\\n    h3 \x7b\\n      text-align: center;\\n      margin-bottom: 20px;\\n      color: #007BFF;\\n      font-size: 24px;\\n    \x7d\\n\\n    label \x7b\\n      font-size: 18px;\\n      margin-top: 10px;\\n      display: block;\\n    \x7d\\n\\n    select, input\x5btype\x3d\\\x22text\\\x22\x5d, button \x7b\\n      width: 100%;\\n      padding: 12px;\\n      margin: 10px 0;\\n      border: 1px solid #ccc;\\n      border-radius: 4px;\\n      box-sizing: border-box;\\n      font-size: 16px;\\n    \x7d\\n\\n    button \x7b\\n      background-color: #007BFF;\\n      color: white;\\n      border: none;\\n      cursor: pointer;\\n      font-size: 16px;\\n      font-weight: bold;\\n    \x7d\\n\\n    button:hover \x7b\\n      background-color: #0056b3;\\n    \x7d\\n\\n    .table-container \x7b\\n      overflow-x: auto;\\n      margin-top: 20px;\\n    \x7d\\n\\n    table \x7b\\n      width: 100%;\\n      border-collapse: collapse;\\n      font-size: 14px;\\n      min-width: 600px;\\n    \x7d\\n\\n    th, td \x7b\\n      padding: 10px;\\n      border: 1px solid #ddd;\\n      text-align: left;\\n    \x7d\\n\\n    th \x7b\\n      background-color: #f2f2f2;\\n    \x7d\\n\\n    @media screen and (max-width: 768px) \x7b\\n      h3 \x7b\\n        font-size: 20px;\\n      \x7d\\n\\n      select, input\x5btype\x3d\\\x22text\\\x22\x5d, button \x7b\\n        padding: 10px;\\n        font-size: 14px;\\n      \x7d\\n\\n      th, td \x7b\\n        padding: 8px;\\n        font-size: 12px;\\n      \x7d\\n\\n      .table-container \x7b\\n        max-height: 400px;\\n      \x7d\\n    \x7d\\n\\n    @media screen and (max-width: 480px) \x7b\\n      h3 \x7b\\n        font-size: 18px;\\n      \x7d\\n\\n      select, input\x5btype\x3d\\\x22text\\\x22\x5d, button \x7b\\n        padding: 8px;\\n        font-size: 12px;\\n      \x7d\\n\\n      th, td \x7b\\n        padding: 6px;\\n        font-size: 10px;\\n      \x7d\\n\\n      .table-container \x7b\\n        max-height: 300px;\\n      \x7d\\n    \x7d\\n\\n    #map \x7b\\n      height: 400px;\\n      width: 100%;\\n      margin-top: 20px;\\n    \x7d\\n  \x3c\\\/style\x3e\\n\x3c\\\/head\x3e\\n\x3cbody\x3e\\n  \x3cdiv class\x3d\\\x22container\\\x22\x3e\\n    \x3ch3\x3eLocalizadorGeo\x3c\\\/h3\x3e\\n    \\n    \x3clabel for\x3d\\\x22column\\\x22\x3eSelecione a Coluna:\x3c\\\/label\x3e\\n    \x3cselect id\x3d\\\x22column\\\x22\x3e\\n      \\n      \x3coption value\x3d\\\x22Unid.leit\\\x22\x3eUnid.leit\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Nome leit\\\x22\x3eNome leit\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Tipo rota\\\x22\x3eTipo rota\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Instal\\\x22\x3eInstal\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Rua\\\x22\x3eRua\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Nº da casa\\\x22\x3eNº da casa\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Sequência\\\x22\x3eSequência\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Contrato\\\x22\x3eContrato\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Latitude localiz.geográfica\\\x22\x3eLatitude localiz.geográfica\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Longitude localiz.geográfica\\\x22\x3eLongitude localiz.geográfica\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Val Fat\\\x22\x3eVal Fat\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22NomeCliente\\\x22\x3eNomeCliente\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Local\\\x22\x3eLocal\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Bairro\\\x22\x3eBairro\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Nº Poste\\\x22\x3eNº Poste\x3c\\\/option\x3e\\n      \x3coption value\x3d\\\x22Nº Serie\\\x22\x3eNº Serie\x3c\\\/option\x3e\\n    \x3c\\\/select\x3e\\n    \\n    \x3clabel for\x3d\\\x22query\\\x22\x3eTermo de Pesquisa:\x3c\\\/label\x3e\\n    \x3cinput type\x3d\\\x22text\\\x22 id\x3d\\\x22query\\\x22 placeholder\x3d\\\x22Digite o termo de pesquisa\\\x22\x3e\\n    \\n    \x3cbutton onclick\x3d\\\x22search()\\\x22\x3ePesquisar\x3c\\\/button\x3e\\n    \\n    \x3cdiv id\x3d\\\x22results\\\x22 class\x3d\\\x22table-container\\\x22\x3e\x3c\\\/div\x3e\\n    \\n    \\n    \x3cdiv id\x3d\\\x22map\\\x22\x3e\x3c\\\/div\x3e\\n  \x3c\\\/div\x3e\\n\\n  \x3cscript src\x3d\\\x22https:\/\/unpkg.com\/leaflet@1.9.4\/dist\/leaflet.js\\\x22\x3e\x3c\\\/script\x3e\\n  \x3cscript\x3e\\n    function search() \x7b\\n      var column \x3d document.getElementById(\x27column\x27).value;\\n      var query \x3d document.getElementById(\x27query\x27).value;\\n      google.script.run.withSuccessHandler(displayResults).searchSheet(column, query);\\n    \x7d\\n\\n    function displayResults(results) \x7b\\n      var output \x3d \x27\x3ctable\x3e\x3ctr\x3e\x27;\\n      output +\x3d \x27\x3cth\x3eUnid.leit\x3c\\\/th\x3e\x3cth\x3eNome leit\x3c\\\/th\x3e\x3cth\x3eTipo rota\x3c\\\/th\x3e\x3cth\x3eInstal\x3c\\\/th\x3e\x27;\\n      output +\x3d \x27\x3cth\x3eRua\x3c\\\/th\x3e\x3cth\x3eNº da casa\x3c\\\/th\x3e\x3cth\x3eSequência\x3c\\\/th\x3e\x3cth\x3eContrato\x3c\\\/th\x3e\x27;\\n      output +\x3d \x27\x3cth\x3eLatitude localiz.geográfica\x3c\\\/th\x3e\x3cth\x3eLongitude localiz.geográfica\x3c\\\/th\x3e\x27;\\n      output +\x3d \x27\x3cth\x3eVal Fat\x3c\\\/th\x3e\x3cth\x3eNomeCliente\x3c\\\/th\x3e\x3cth\x3eLocal\x3c\\\/th\x3e\x3cth\x3eBairro\x3c\\\/th\x3e\x27;\\n      output +\x3d \x27\x3cth\x3eNº Poste\x3c\\\/th\x3e\x3cth\x3eNº Serie\x3c\\\/th\x3e\x3c\\\/tr\x3e\x27;\\n      \\n      var locations \x3d \x5b\x5d;\\n      \\n      for (var i \x3d 0; i \x3c results.length; i++) \x7b\\n        output +\x3d \x27\x3ctr\x3e\x27;\\n        for (var j \x3d 0; j \x3c results\x5bi\x5d.length; j++) \x7b\\n          output +\x3d \x27\x3ctd\x3e\x27 + results\x5bi\x5d\x5bj\x5d + \x27\x3c\\\/td\x3e\x27;\\n        \x7d\\n        output +\x3d \x27\x3c\\\/tr\x3e\x27;\\n        \\n        \\n        var latitude \x3d parseFloat(results\x5bi\x5d\x5b8\x5d);\\n        var longitude \x3d parseFloat(results\x5bi\x5d\x5b9\x5d);\\n        if (!isNaN(latitude) \x26\x26 !isNaN(longitude)) \x7b\\n          locations.push(\x7b\\n            coords: \x5blatitude, longitude\x5d,\\n            data: results\x5bi\x5d\\n          \x7d);\\n        \x7d\\n      \x7d\\n      \\n      output +\x3d \x27\x3c\\\/table\x3e\x27;\\n      document.getElementById(\x27results\x27).innerHTML \x3d output;\\n      \\n      \\n      displayMap(locations);\\n    \x7d\\n\\n    function displayMap(locations) \x7b\\n      var map \x3d L.map(\x27map\x27).setView(\x5b0, 0\x5d, 2); \\n      \\n      L.tileLayer(\x27https:\/\/\x7bs\x7d.tile.openstreetmap.org\/\x7bz\x7d\/\x7bx\x7d\/\x7by\x7d.png\x27, \x7b\\n        attribution: \x27\x26copy; \x3ca href\x3d\\\x22https:\/\/www.openstreetmap.org\/copyright\\\x22\x3eOpenStreetMap\x3c\\\/a\x3e contributors\x27\\n      \x7d).addTo(map);\\n\\n      if (locations.length \x3e 0) \x7b\\n        map.setView(locations\x5b0\x5d.coords, 10); \\n      \x7d\\n\\n      locations.forEach(function(location) \x7b\\n        var popupContent \x3d \x27\x3cb\x3eUnid.leit:\x3c\\\/b\x3e \x27 + location.data\x5b0\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eInstal:\x3c\\\/b\x3e \x27 + location.data\x5b3\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eNomeCliente:\x3c\\\/b\x3e \x27 + location.data\x5b11\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eLocal:\x3c\\\/b\x3e \x27 + location.data\x5b12\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eBairro:\x3c\\\/b\x3e \x27 + location.data\x5b13\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eRua:\x3c\\\/b\x3e \x27 + location.data\x5b4\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eNº da casa:\x3c\\\/b\x3e \x27 + location.data\x5b5\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eContrato:\x3c\\\/b\x3e \x27 + location.data\x5b7\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eNº Poste:\x3c\\\/b\x3e \x27 + location.data\x5b14\x5d + \x27\x3cbr\x3e\x27 +\\n                           \x27\x3cb\x3eNº Serie:\x3c\\\/b\x3e \x27 + location.data\x5b15\x5d;\\n        \\n        L.marker(location.coords).addTo(map)\\n          .bindPopup(popupContent)\\n          .openPopup();\\n      \x7d);\\n    \x7d\\n  \x3c\\\/script\x3e\\n\x3c\\\/body\x3e\\n\x3c\\\/html\x3e\\n\x22,\x22ncc\x22:\x22\x7b\\\x22awhs\\\x22:true\x7d\x22\x7d", "AJuLMu38Dj6HKERnGyukGkp5MErYjcKw_g:1727403740882", undefined, true , true  , "true", "https:\/\/n-vdleir65377mpxdm46abhh6k3gsnscuj7li75mq-0lu-script.googleusercontent.com", "\/\/drive.google.com\/abuse?id\x3dAKkXjozLcMD29z0l3WhFJVL04zIadOS0_MBuaUfmSWrDz8whJ-mlF8Lv-oQNrcVklI8rZARoXEMWI5ZnQPSJFTAIXlOq7hto7Zwi-8rj%3A0\x26docurl\x3dhttps%3A%2F%2Fscript.google.com%2Fmacros%2Fs%2FAKfycbyjQUTSv0uXvhSb2ML7Z9CF2kCFn6gQBL3Y-wSPoYDUJflIQmwf7Pm9j6cW1oT2w6Rs%2Fexec");}
el.src = 'https:\/\/n-vdleir65377mpxdm46abhh6k3gsnscuj7li75mq-0lu-script.googleusercontent.com\/userCodeAppPanel';
}());
</script>
</body>
</html>
